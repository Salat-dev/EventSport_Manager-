import{Y as s,e as a,j as e,Z as P,$ as b,a0 as u,a1 as U,a2 as A,a3 as f,a4 as V,a5 as o,a6 as r,M as $,J as F,a7 as M}from"./index-C9xESR5Z.js";const{Option:n}=u,k=()=>{const[h]=s.useForm(),[_,g]=a.useState(!1),[y,I]=a.useState([]),[w,v]=a.useState([]),[d,p]=a.useState(null),[S,m]=a.useState(!1);a.useEffect(()=>{const t=async()=>{const{data:i,error:c}=await o.from("clubs").select("club_name");c?r.error("Erreur lors de la récupération des clubs"):I(i)},l=async()=>{const{data:i,error:c}=await o.from("kumite_categories").select(" weight_category");c?r.error("Erreur lors de la récupération des categories"):v(i)};t(),l()},[]);const C=async({file:t,onSuccess:l,onError:i})=>{m(!0);const c=t.name.split(".").pop(),x=`${Date.now()}.${c}`,{data:q,error:j}=await o.storage.from("athlete_images").upload(`public/${x}`,t);if(j)r.error("Erreur lors de l'upload de l'image"),i(j),m(!1);else{const{publicUrl:z}=o.storage.from("athlete_images").getPublicUrl(`public/${x}`).data;p(z),r.success("Image uploadée avec succès"),l(q),m(!1)}},E=async t=>{g(!0);const{error:l}=await o.from("athlete_club").insert([{first_name:t.first_name,last_name:t.last_name,club:t.club,level:t.level,weight:t.weight,birth_date:t.birth_date,image_url:d||null}]);l?r.error("Erreur lors de l'enregistrement des données"):(r.success("Athlète enregistré avec succès"),h.resetFields(),p(null)),g(!1)};return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"90vh"},children:e.jsxs(P,{style:{width:"60%",padding:"2rem",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},children:[e.jsx("h2",{style:{textAlign:"center"},children:"Inscription Athlète"}),e.jsxs(s,{form:h,layout:"vertical",onFinish:E,children:[e.jsx(s.Item,{label:"Nom de l'athlète",name:"last_name",rules:[{required:!0,message:"Veuillez entrer le nom de l'athlète"}],children:e.jsx(b,{placeholder:"Nom"})}),e.jsx(s.Item,{label:"Prénom de l'athlète",name:"first_name",rules:[{required:!0,message:"Veuillez entrer le prénom de l'athlète"}],children:e.jsx(b,{placeholder:"Prénom"})}),e.jsx(s.Item,{label:"Club",name:"club",rules:[{required:!0,message:"Veuillez sélectionner un club"}],children:e.jsx(u,{placeholder:"Sélectionner un club",children:y.map((t,l)=>e.jsx(n,{value:t.club_name,children:t.club_name},l))})}),e.jsx(s.Item,{label:"Niveau",name:"level",rules:[{required:!0,message:"Veuillez sélectionner un niveau"}],children:e.jsxs(u,{placeholder:"Sélectionner le niveau",children:[e.jsx(n,{value:"Cadets",children:"Cadets"}),e.jsx(n,{value:"Juniors",children:"Juniors"}),e.jsx(n,{value:"Minims",children:"Minims"}),e.jsx(n,{value:"Seniors",children:"Seniors"})]})}),e.jsx(s.Item,{label:"Categories",name:"weight",rules:[{required:!0,message:"Veuillez entrer le poids de l'athlète"}],children:e.jsx(u,{placeholder:"Sélectionner un club",children:w.map((t,l)=>e.jsx(n,{value:t.weight_category,children:t.weight_category},l))})}),e.jsx(s.Item,{label:"Date de naissance",name:"birth_date",rules:[{required:!0,message:"Veuillez sélectionner la date de naissance"}],children:e.jsx(U,{placeholder:"Date de naissance",style:{width:"100%"}})}),e.jsxs(s.Item,{label:"Photo de l'athlète",children:[e.jsx(A,{name:"image",customRequest:C,listType:"picture",accept:"image/*",maxCount:1,children:e.jsx(f,{icon:e.jsx(V,{}),loading:S,children:"Télécharger une photo (Optionnel)"})}),d&&e.jsx("img",{src:d,alt:"Preview",style:{width:"100%",marginTop:"10px"}})]}),e.jsx(s.Item,{children:e.jsx(f,{type:"primary",htmlType:"submit",block:!0,loading:_,children:"Enregistrer"})})]})]})})},N=()=>e.jsxs($,{title:"Enregistrez les Informations de l'athlète",children:[e.jsx(F,{style:{position:"relative",top:"-80px",marginLeft:"700px"},variant:"contained",startIcon:e.jsx(M,{}),children:"Afficher la Liste"}),e.jsx(k,{})]});export{N as default};
